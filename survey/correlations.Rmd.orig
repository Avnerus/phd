---
title: "correlations"
author: "Avner Peled"
date: "5/19/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(corrr)
library(ggcorrplot)
```


# Biserial correlation between one question (Robot would have my religion) and value of the feeling thermometer for the outgroup

```{r}
<<<<<<< HEAD
corr_df <- Telerobot_ages %>%
  drop_na("Q_GROUP_INTEREST_1") %>%
  dplyr::select(
    "Q_ROBOT_NARS",
    "Q_AGE_GROUP",
    "Q_TECH_CONFIDENCE",
    "Q_GROUP_INTEREST_1",
    "Q_GROUP_INTEREST_2",
    "Q_GROUP_INTEREST_3",
    "Q_GROUP_INTEREST_4"
  )
ggcorrplot(corr_df %>% cor,
           hc.order = TRUE,
           type = "lower",
           p.mat = corr_df %>% cor_pmat)
```


```{r}
corr_df <- Telerobot_ages %>%
  drop_na("Q_TELEROBOT_WOULD_U_1") %>%
  dplyr::select(
    "Q_ROBOT_NARS",
    "Q_AGE",
    "Q_TECH_CONFIDENCE",
    "Q_TELEROBOT_WOULD_U_1",
    "Q_TELEROBOT_WOULD_U_2",
    "Q_TELEROBOT_WOULD_U_3"
  )
corr_df %>% cor_pmat

ggcorrplot(corr_df %>% cor,
           hc.order = TRUE,
           type = "lower",
           lab = TRUE,
           p.mat = corr_df %>% cor_pmat)
```
```{r}
corr_vars <- c(
    "v_N",
    "Q_ROBOT_NARS",
    "Q_AGE",
    "Q_TECH_CONFIDENCE",
    "Q_TELEROBOT_WOULD_U_1",
    "Q_TELEROBOT_WOULD_U_2",
    "Q_TELEROBOT_WOULD_U_3"
  )

names <- c(
    "Nationality",
    "NARS",
    "Age",
    "Tech confidence",
    "Approach",
    "Host",
    "Operate"
  )
Telerobot_ages %>%
  mutate(v_N = case_when(
                      v == "PS" ~ 1,
                      v == "IL" ~ 2
  )) %>%
  drop_na("Q_TELEROBOT_WOULD_U_1") %>%
  dplyr::select(
    "v_N",
    corr_vars
  ) %>%
  mutate_all(as.numeric) %>%
  ggcorrmat(cor.vars = corr_vars, cor.vars.names = names)
```


```{r}
corr_vars <- c(
    "Q_ROBOT_NARS",
    "Q_AGE",
    "Q_TECH_CONFIDENCE",
    "Q_TELEROBOT_WOULD_U_1",
    "Q_TELEROBOT_WOULD_U_2",
    "Q_TELEROBOT_WOULD_U_3"
  )

names <- c(
    "NARS",
    "Age",
    "Tech confidence",
    "Approach",
    "Host",
    "Operate"
  )
Telerobot_ages %>%
  mutate(v_N = case_when(
                      v == "PS" ~ 1,
                      v == "IL" ~ 2
  )) %>%
  drop_na("Q_TELEROBOT_WOULD_U_1") %>%
  dplyr::select(
    "v",
    corr_vars
  ) %>%
  mutate_at(corr_vars, as.numeric) %>%
  grouped_ggcorrmat(cor.vars = corr_vars, cor.vars.names = names, grouping.var = "v")
```
=======
select <- dplyr::select
cor_df <- Telerobot_sorted %>% 
  select("Q_TELEROBOT_IDENT_5", "Q_GROUP_SLIDER_1") %>%
  drop_na("Q_GROUP_SLIDER_1") %>%
  mutate_at(c("Q_TELEROBOT_IDENT_5"), funs(ifelse(is.na(.), 0, .)))

print(biserial.cor(cor_df$Q_GROUP_SLIDER_1, cor_df$Q_TELEROBOT_IDENT_5))
plot(cor_df)
````

>>>>>>> dc90f0ea134fecc9149a8b7b9579c9a15e922577
