, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=reorder(IDENT, value_freq),y=value_freq,color=IDENT,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,color=IDENT,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,color=IDENT,fill=type) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,color=IDENT,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
View(df)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO"))))
ggplot(df, aes(x=IDENT,y=value_freq,color=IDENT,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,color=IDENT,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
ggplot(df) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(aes(x=IDENT,y=value_freq,color=IDENT,fill=type), position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(aes(x=IDENT,y=value_freq,color=IDENT,fill=type), position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,color=IDENT,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)[,1]]))))
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
# ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
df
# ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)][,1]))))
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)][,0]))))
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)])[,1])))
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ paste0("BOO",COLUMN_DICTIONARY[toString(.x)]))))
df
# ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ unlist(COLUMN_DICTIONARY[toString(.x)]))))
df
# ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ map(.x,~ COLUMN_DICTIONARY[toString(.x)])))
df
# ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
df
# ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
View(df)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Normal","Outgroup")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,fill=type,color=IDENT)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,fill=type,color=IDENT)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=IDENT,y=value_freq,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
# ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
df
# ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=type)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(position="dodge", stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_G"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_G")),replace_na, 0) %>%
plyr::rename(COLUMN_DICTIONARY)
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n())))
df
#
# ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,color=IDENT)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>%   filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>% select(matches("^Q_TELEROBOT_IDENT_\\d$"), 'ResponseId','v') %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT")),replace_na, 0) %>%
plyr::rename(COLUMN_DICTIONARY)
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n())))
df
# ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,color=IDENT)) +
# ylab("Percentage") +
# xlab("Robot identity") +
# geom_bar(stat="identity") +
# coord_flip() +
# facet_wrap(~ v,
#   labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
# )
df <- melt(
Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%
filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)# %>%
, id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
group_by(v,IDENT) %>%
summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))
ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=type)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(position="dodge", stat="identity") +
coord_flip() +
facet_wrap(~ v,
labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
