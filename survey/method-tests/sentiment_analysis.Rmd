---
title: "Sentiment analysis"
author: "Avner Peled"
date: "5/16/2021"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r , include=FALSE}
library(dplyr)
library(magrittr)
library(knitr)
library(tidytext)
library(textdata)
library(wordcloud)
library(ggplot2)
#load("/home/avnerus/Code/R/survey/tests.RData")
#knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown analysis

Sentiments for the (translated) question:
_Imagine you would have the opportunity to interact with a robot that is operated by a person in another location. 
How would that compare to meeting a person face-to-face?_

```{r}
sentiments <- Telerobot_sorted %>% 
  select("v","Q_TELEROBOT_VS_F2F_TRANS") %>%
  unnest_tokens(word, "Q_TELEROBOT_VS_F2F_TRANS") %>%
  inner_join(get_sentiments("bing")) %>%
  count(v, sentiment) %>%
  group_by(v)  %>%
  mutate(freq = n / sum(n))

ggplot(sentiments,aes(x=sentiment, y=freq, color=v)) + 
  geom_bar(stat="identity") + 
  facet_wrap(~ v) 

```
  
## Question
Imagine you could operate your telerobot anywhere in the world.
What places would you want to visit with your robot avatar and what kind of activities would you have it perform?

## Word cloud
```{r, fig.width=12,fig.asp=0.5}

df <- Telerobot_sorted %>% 
  dplyr::filter(v == "IL") %>%
  select("Q_TELEROBOT_VS_F2F_TRANS") %>%
  drop_na() 

  df %>%
  unnest_tokens(word, "Q_TELEROBOT_VS_F2F_TRANS") %>%
  anti_join(stop_words) %>%
  count(word) %>%
  filter(!grepl("(do[es]*n['’]t)|(person)|(robot)|(meeting)", .$word)) %>%
  with(wordcloud(word, n, max.words = 100, scale = c(5,1), colors=brewer.pal(8, "Dark2")))
  #arrange(desc(n))


df <- Telerobot_sorted %>% 
  dplyr::filter(v == "PS") %>%
  select("Q_TELEROBOT_VS_F2F_TRANS") %>%
  drop_na()


  df %>%
  unnest_tokens(word, "Q_TELEROBOT_VS_F2F_TRANS") %>%
  anti_join(stop_words) %>%
  count(word) %>%
  filter(!grepl("(do[es]*n['’]t)|(person)|(robot)|(meeting)", .$word)) %>%
  with(wordcloud(word, n, max.words = 100, scale = c(3.5,.5), colors=brewer.pal(8, "Dark2")))
  #arrange(desc(n))

```
## Word cloud 2read
```{r, fig.width=12,fig.asp=0.5}

Telerobot_sorted %>% select(v,Q_TELEROBOT_IMAGINE_TRANS) %>% drop_na() %>% filter(Q_TELEROBOT_IMAGINE_TRANS != "") %>% count(v)

df <- Telerobot_ages %>% 
  dplyr::filter(v == "IL") %>%
  select("Q_TELEROBOT_IMAGINE_TRANS") %>%
  drop_na() 


  df %>%
  unnest_tokens(word, "Q_TELEROBOT_IMAGINE_TRANS") %>%
  anti_join(stop_words) %>%
  count(word) %>%
  filter(!grepl("(.*n['’]t)|(robot)", .$word)) %>%
  #with(wordcloud(word, n, max.words = 50, scale = c(3.5,.5), colors=brewer.pal(8, "Dark2")))
  mutate(freq = sprintf("%0.2f%%",n / sum(n) * 100)) %>% arrange(desc(n))


  df %>%
  unnest_tokens(word, "Q_TELEROBOT_IMAGINE_TRANS") %>%
  anti_join(stop_words) %>%
  count(word) %>%
  filter(!grepl("(.*n['’]t)|(robot)", .$word)) %>%
  #with(wordcloud(word, n, max.words = 50, scale = c(5,1), colors=brewer.pal(8, "Dark2")))
  mutate(freq = sprintf("%0.2f%%",n / sum(n) * 100)) %>% arrange(desc(n))



df <- Telerobot_ages %>% 
  dplyr::filter(v == "PS") %>%
  select("Q_TELEROBOT_IMAGINE_TRANS") %>%
  drop_na()


  df %>%
  unnest_tokens(word, "Q_TELEROBOT_IMAGINE_TRANS") %>%
  anti_join(stop_words) %>%
  count(word) %>%
  filter(!grepl("(.*n['’]t)|(robot)", .$word)) %>%
  #with(wordcloud(word, n, max.words = 50, scale = c(3.5,.5), colors=brewer.pal(8, "Dark2")))
  mutate(freq = sprintf("%0.2f%%",n / sum(n) * 100)) %>% arrange(desc(n))
```


## Word cloud 3
```{r}
Telerobot_sorted %>% 
  select("Q_SHOW_DETAIL_TRANS") %>%
  filter(!grepl("don['’]t", Telerobot_sorted$Q_SHOW_DETAIL_TRANS)) %>%
  unnest_tokens(word, "Q_SHOW_DETAIL_TRANS") %>%
  anti_join(stop_words) %>%
  count(word) %>%
  with(wordcloud(word, n, max.words = 100, scale = c(25,1), colors=brewer.pal(8, "Dark2")))
```