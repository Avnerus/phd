---
title: "Research Questions"
author: "Avner Peled"
date: "9/27/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggpubr)
library(tidyr)
library(reshape2)
library(grid)
library(purrr)
library(haven)
library(rstatix)
```
```{r}
COLUMN_DICTIONARY <-
  c(
    Q_GROUP_INTEREST_1 = "Telerobot",
    Q_GROUP_INTEREST_2 = "Telepuppet",
    Q_GROUP_INTEREST_3 = "F2F",
    Q_GROUP_INTEREST_4 = "Video",
    Q_SHOW_INTEREST = "Puppet show",
    Q_TELEROBOT_IDENT_1 = "Same nationality",
    Q_TELEROBOT_IDENT_2 = "Same age",
    Q_TELEROBOT_IDENT_3 = "Same gender",
    Q_TELEROBOT_IDENT_4 = "Same voice",
    Q_TELEROBOT_IDENT_5 = "Same religion",
    Q_TELEROBOT_IDENT_6 = "Bring additional objects",
    Q_TELEROBOT_IDENT_7 = "Would not reveal myself",
    Q_TELEROBOT_IDENT_8 = "Be someone else",
    Q_TELEROBOT_IDENT_G_1 = "Same nationality",
    Q_TELEROBOT_IDENT_G_2 = "Same age",
    Q_TELEROBOT_IDENT_G_3 = "Same gender",
    Q_TELEROBOT_IDENT_G_4 = "Same voice",
    Q_TELEROBOT_IDENT_G_6 = "Same religion",
    Q_TELEROBOT_IDENT_G_9 = "Bring additional objects",
    Q_TELEROBOT_IDENT_G_10 = "Would not reveal myself",
    Q_TELEROBOT_IDENT_G_11 = "Be someone else",
    IDENT_1_DIFF = "Same nationality",
    IDENT_2_DIFF = "Same age",
    IDENT_3_DIFF = "Same gender",
    IDENT_4_DIFF = "Same voice",
    IDENT_5_DIFF = "Same religion",
    IDENT_6_DIFF = "Bring additional objects",
    IDENT_7_DIFF = "Would not reveal myself",
    IDENT_8_DIFF = "Be someone else",
    Q_TELEROBOT_FEAT_1 = "Translate speech",
    Q_TELEROBOT_FEAT_2 = "Travel around",
    Q_TELEROBOT_FEAT_3 = "Hand gestures",
    Q_TELEROBOT_FEAT_4 = "Touch feedback",
    Q_TELEROBOT_FEAT_5 = "Show emotions",
    Q_TELEROBOT_FEAT_6 = "Play online content",
    Q_TELEROBOT_FEAT_7 = "Show personal content",
    Q_TELEROBOT_FEAT_8 = "Play games",
    Q_TELEROBOT_FEAT_9 = "Suggest topics",
    Q_TELEROBOT_FEAT_G_1 = "Translate speech",
    Q_TELEROBOT_FEAT_G_2 = "Travel around",
    Q_TELEROBOT_FEAT_G_3 = "Hand gestures",
    Q_TELEROBOT_FEAT_G_4 = "Touch feedback",
    Q_TELEROBOT_FEAT_G_5 = "Show emotions",
    Q_TELEROBOT_FEAT_G_6 = "Play online content",
    Q_TELEROBOT_FEAT_G_7 = "Show personal content",
    Q_TELEROBOT_FEAT_G_8 = "Play games",
    Q_TELEROBOT_FEAT_G_9 = "Suggest topics",
    FEAT_1_DIFF = "Translate speech",
    FEAT_2_DIFF = "Travel around",
    FEAT_3_DIFF = "Hand gestures",
    FEAT_4_DIFF = "Touch feedback",
    FEAT_5_DIFF = "Show emotions",
    FEAT_6_DIFF = "Play online content",
    FEAT_7_DIFF = "Show personal content",
    FEAT_8_DIFF = "Play games",
    FEAT_9_DIFF = "Suggest topics"
)
```


```{r}
paste0(COLUMN_DICTIONARY["Q_TELEROBOT_IDENT_G_10"])

```

# Data outline

The following data is available for the survey participants.

## Demographics

 - **Age**: Continuous (1 year intervals, can be treated as continuous)
 - **Gender**: Nominal (Female/Male/Other).
 - **Tech confidence**: Ordinal (1-5).
 - **Spoken languages**: Nominal (checkboxes)
 - **Prior experience** - Dichotomous Y/N questions:
   1. Own a smartphone.
   2. Own a computer.
   3. Interacted with robots.
   4. Used glove puppets.
   5. Participated in intergroup encounters.
   6. Intergroup friends.


## General robot attitude

- **NARS Scale**: Continuous (lower is more positive attitude).
- **Feeling thermometer**: Continuous (higher is more positive).
- **Willingness to interact** - Ordinal 1-5s:
  1. _Approach_ a robot in a public space.
  2. _Own_ a robot used for interaction.
  3. _Operate_ a robot in a public space.
- **Imagine interaction**: Open text.

- **Interested to design a robot**: Dichotomous Y/N.

## Robot design preference

  - **What appearance** - Nominal: Human/animal or plant/machine/abstract/other
  - **How would it reflect me?** Dichotomous Y/N questions:
   1. Same nationality.
   2. Same age.
   3. Same gender.
   4. Same voice.
   5. Same religion.
   6. Additional objects.
   7. Not reveal anything.
   8. Be someone else.
   
 - **Features** - Ordinal 1-5s:
    1. Translate speech.
    2. Travel in space.
    3. Make hand gestures.
    4. Can tell when it is touched.
    5. Can show emotions.
    6. Can play content from the internet.
    7. Can show personal photos.
    8. Can play games.
    
  - **Other features** : Open text.
    
 - **Visiblity**: Nominal
   1. See and not be seee.
   2. See and be seen.
   3. Not see and not be seen.
   
## Robot puppet theater attitude
  - **Interested to perform**: Ordinal 1-5.
  - **What kind** : Open text.
  
## Attitude toward outgroup

- **Feeling thermometer**: Continuous (higher is more positive).
- - **Willingness to interact** - Ordinal 1-5s:
  1. _Operate_ a robot.
  2. _Perform_ a puppet.
  3. Face to face.
  4. Meet online.
  
## Robot preference when meeting outgroup

 - Duplicate of _Robot design preference_
 

# Research questions

## Respondents demographics
### Q: Was there an age difference?
```{r}
Telerobot_ages %>% 
#dplyr::filter(Finished == 1) %>%
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
anova_test(Q_AGE ~ v)
```

## General attitude toward robots

### Q: How are the robot feeling thermometers distributed?
```{r}
ggdensity(Telerobot_ages %>% select(Q_ROBOTS_SLIDER_4,v),x = "Q_ROBOTS_SLIDER_4", fill = "lightblue",facet.by = "v")
```
## And NARS?
```{r}
ggdensity(Telerobot_ages %>% select(Q_ROBOT_NARS,v) %>% mutate(Q_ROBOT_NARS_INV = Q_ROBOT_NARS * -1) ,x = "Q_ROBOT_NARS_INV", fill = "lightgreen",facet.by = "v")
```

## Telerobot preference

### Robot appearance style
```{r, fig.width=10,fig.asp=0.5}
df <-
  Telerobot_ages %>% select("Q_TELEROBOT_APP", 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(Appearance=as_factor(Q_TELEROBOT_APP)) %>%
  group_by(v,Appearance) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n), total_n = sum(n))

ggplot(df, aes(x="", y=freq,fill=Appearance)) +
ylab("Percentage") +
xlab("Robot appearance") +
geom_bar(stat="identity") +
coord_polar("y", start=0) +
facet_wrap(~ v,
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$total_n[1] ,")")))
)
```
### In outgroup scenario
```{r, fig.width=10,fig.asp=0.5}
df <-
  Telerobot_ages %>% select("Q_TELEROBOT_APP_G", 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(Appearance=as_factor(Q_TELEROBOT_APP_G)) %>%
  group_by(v,Appearance) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n), total_n = sum(n))

ggplot(df, aes(x="", y=freq,fill=Appearance)) +
ylab("Percentage") +
xlab("Robot appearance") +
geom_bar(stat="identity") +
coord_polar("y", start=0) +
facet_wrap(~ v,
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$total_n[1] ,")")))
)
```




### Q: Do Palestinians want significantly more a machine appearance than Israelis?
```{r}
Telerobot_ages %>% 
select("Q_TELEROBOT_APP", 'ResponseId','v','Q_DEMOGRAPHICS_2', 'Q_AGE') %>%
drop_na() %>%
mutate(APP_MACHINE = (as_factor(Q_TELEROBOT_APP) == 'A machine.')) %>%
anova_test(APP_MACHINE ~ v * Q_AGE)

```

### Q: How did participants prefer the robot identity? 
From those that selected anything.
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>% select(matches("^Q_TELEROBOT_IDENT_\\d$"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT")),replace_na, 0) %>%
  plyr::rename(COLUMN_DICTIONARY)
 , id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
  group_by(v,IDENT) %>%
  summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n())))

  ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=IDENT)) + 
  ylab("Percentage") +
  xlab("Robot identity") +
  geom_bar(stat="identity") +
  coord_flip() + 
  facet_wrap(~ v, 
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
  )
 
```
### And when meeting the outgroup?
```{r, fig.width=10}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_G"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_G")),replace_na, 0) %>%
  plyr::rename(COLUMN_DICTIONARY)
 , id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
  group_by(v,IDENT) %>%
  summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n())))

ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,color=IDENT)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v, 
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)

```
### Comparision of means between meeting and normal

```{r, fig.width=10}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)
 , id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
  group_by(v,IDENT) %>%
  summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
  mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
  mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))

 ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=type)) +
 ylab("Percentage") +
 xlab("Robot identity") +
 geom_bar(position="dodge", stat="identity") +
 coord_flip() +
 facet_wrap(~ v,
     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
 )
```
### Means of individual difference between normal and outgruop
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>%  
  filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0) %>%
  mutate(
    IDENT_1_DIFF = Q_TELEROBOT_IDENT_G_1 - Q_TELEROBOT_IDENT_1,
    IDENT_2_DIFF = Q_TELEROBOT_IDENT_G_2 - Q_TELEROBOT_IDENT_2,
    IDENT_3_DIFF = Q_TELEROBOT_IDENT_G_3 - Q_TELEROBOT_IDENT_3,
    IDENT_4_DIFF = Q_TELEROBOT_IDENT_G_4 - Q_TELEROBOT_IDENT_4,
    IDENT_5_DIFF = Q_TELEROBOT_IDENT_G_6 - Q_TELEROBOT_IDENT_5,
    IDENT_6_DIFF = Q_TELEROBOT_IDENT_G_9 - Q_TELEROBOT_IDENT_6,
    IDENT_7_DIFF = Q_TELEROBOT_IDENT_G_10 - Q_TELEROBOT_IDENT_7,
    IDENT_8_DIFF = Q_TELEROBOT_IDENT_G_11 - Q_TELEROBOT_IDENT_8
  ) %>% 
  select(matches("_DIFF"), 'ResponseId','v')  %>% plyr::rename(COLUMN_DICTIONARY,warn_missing = FALSE)
 , id=c('ResponseId','v'),variable.name = "IDENT_DIFF"
) %>%
group_by(v,IDENT_DIFF) %>%
summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n())))

ggplot(df, aes(x=reorder(IDENT_DIFF, -value_mean),y=value_mean,fill=IDENT_DIFF)) + 
ylab("Mean individual difference between outgroup and normal scenario") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() + 
facet_wrap(~ v, 
  labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)

```

### Q: How did participants rate the robot's feature importance? 
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>% select(matches("^Q_TELEROBOT_FEAT_\\d$"), 'ResponseId','v') %>%    
  drop_na() %>%
  plyr::rename(COLUMN_DICTIONARY,warn_missing = FALSE)
 , id=c('ResponseId','v'),variable.name = "FEAT"
) %>%
  group_by(v,FEAT) %>%
  summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n())))

  ggplot(df, aes(x=reorder(FEAT, -value_mean),y=value_mean,fill=FEAT)) + 
  ylab("Mean rank") +
  xlab("Robot feature") +
  geom_bar(stat="identity") +
  coord_flip() + 
  facet_wrap(~ v, 
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
  )
 
```

## Comparison between normnal and outgroup meeting
```{r, fig.width=10}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_FEAT_"), 'ResponseId','v') %>%    
  drop_na()
 , id=c('ResponseId','v'),variable.name = "FEAT"
) %>%
  group_by(v,FEAT) %>%
  summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n()))) %>%
  mutate(type = if_else(grepl("Q_TELEROBOT_FEAT_G", FEAT),"Outgroup","Normal")) %>%
  mutate(across(FEAT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))

 ggplot(df, aes(x=reorder(FEAT, -value_mean),y=value_mean,fill=type)) +
 ylab("Mean") +
 xlab("Robot feature") +
 geom_bar(position="dodge", stat="identity") +
 coord_flip() +
 facet_wrap(~ v,
     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
 )
```
### And individual change
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_FEAT_"), 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(
    FEAT_1_DIFF = Q_TELEROBOT_FEAT_G_1 - Q_TELEROBOT_FEAT_1,
    FEAT_2_DIFF = Q_TELEROBOT_FEAT_G_2 - Q_TELEROBOT_FEAT_2,
    FEAT_3_DIFF = Q_TELEROBOT_FEAT_G_3 - Q_TELEROBOT_FEAT_3,
    FEAT_4_DIFF = Q_TELEROBOT_FEAT_G_4 - Q_TELEROBOT_FEAT_4,
    FEAT_5_DIFF = Q_TELEROBOT_FEAT_G_5 - Q_TELEROBOT_FEAT_5,
    FEAT_6_DIFF = Q_TELEROBOT_FEAT_G_6 - Q_TELEROBOT_FEAT_6,
    FEAT_7_DIFF = Q_TELEROBOT_FEAT_G_7 - Q_TELEROBOT_FEAT_7,
    FEAT_8_DIFF = Q_TELEROBOT_FEAT_G_8 - Q_TELEROBOT_FEAT_8,
    FEAT_9_DIFF = Q_TELEROBOT_FEAT_G_9 - Q_TELEROBOT_FEAT_9
  ) %>% 
  select(matches("_DIFF"), 'ResponseId','v')  %>% plyr::rename(COLUMN_DICTIONARY,warn_missing = FALSE)
 , id=c('ResponseId','v'),variable.name = "FEAT_DIFF"
) %>%
group_by(v,FEAT_DIFF) %>%
summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n())))

ggplot(df, aes(x=reorder(FEAT_DIFF, -value_mean),y=value_mean,fill=FEAT_DIFF)) + 
ylab("Mean individual difference between outgroup and normal scenario") +
xlab("Robot features") +
geom_bar(stat="identity") +
coord_flip() + 
facet_wrap(~ v, 
  labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
```

### Visibility preferences
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>% select(matches("^Q_TELEROBOT_IDENT_\\d$"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT")),replace_na, 0) %>%
  plyr::rename(COLUMN_DICTIONARY)
 , id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
  group_by(v,IDENT) %>%
  summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n())))

  ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=IDENT)) + 
  ylab("Percentage") +
  xlab("Robot identity") +
  geom_bar(stat="identity") +
  coord_flip() + 
  facet_wrap(~ v, 
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
  )
```  

## General attitude toward outgroup

## Interest in contact

### Q: How the outgruop feeling thermometers distributed?
```{r}
ggdensity(Telerobot_ages %>% select(Q_GROUP_SLIDER_1,v),x = "Q_GROUP_SLIDER_1", fill = "lightgray",facet.by = "v")
```
### Q: How willing are the groups to meat each other with the different scenarios?

```{r, fig.width=10,fig.asp=0.5}
  ggsummarystats(
  melt(Telerobot_ages %>% select(starts_with("Q_GROUP_INTEREST"), 'ResponseId','v') %>% drop_na() %>%     plyr::rename(COLUMN_DICTIONARY), id=c('ResponseId','v'),variable.name = "INTEREST"),
  x = "INTEREST", y = "value",
  ggfunc = ggboxplot, palette="npg", add="jitter", color="INTEREST",
  summaries = c("n", "median", "mean"),
  digits = 3,
  table.font.size = 3,
  facet.by = "v",
)
```


## Potential of telepuppets

### Q: What is the level of interest in performing a puppet show? How do these compare with other interests
```{r, fig.width=10,fig.asp=0.5}
  ggsummarystats(
  melt(Telerobot_ages %>% select(starts_with("Q_GROUP_INTEREST"), 'Q_SHOW_INTEREST', 'ResponseId','v') %>% drop_na() %>%     plyr::rename(COLUMN_DICTIONARY), id=c('ResponseId','v'),variable.name = "INTEREST"),
  x = "INTEREST", y = "value",
  ggfunc = ggboxplot, palette="npg", add="jitter", color="INTEREST",
  summaries = c("n", "median", "mean"),
  digits = 3,
  table.font.size = 3,
  facet.by = "v",
)
```

Generally there was
Since only 27 Palestinians made it to this stage, it might be best to investigate individual stories.

### Q: How were answers to the puppet show relative to average interest to meeet?


```{r}
Telerobot_ages %>% select(starts_with("Q_GROUP_INTEREST"), 'ResponseId','v', 'Q_SHOW_INTEREST') %>% drop_na() %>%     
mutate(Q_GROUP_INTEREST_AVG = rowMeans(select(.,starts_with("Q_GROUP_INTEREST")), na.rm = TRUE)) %>%
mutate(DIFF = Q_SHOW_INTEREST - Q_GROUP_INTEREST_AVG) %>%
  group_by(v) %>%
  get_summary_stats(DIFF)
```
There was generally less interest in the puppet show


