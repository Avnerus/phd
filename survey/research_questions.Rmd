---
title: "Research Questions"
author: "Avner Peled"
date: "9/27/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggpubr)
library(tidyr)
library(reshape2)
library(grid)
library(purrr)
library(haven)
library(rstatix)
```
```{r}
COLUMN_DICTIONARY <-
  c(
    Q_GROUP_INTEREST_1 = "Telerobot",
    Q_GROUP_INTEREST_2 = "Telepuppet",
    Q_GROUP_INTEREST_3 = "F2F",
    Q_GROUP_INTEREST_4 = "Video",
    Q_SHOW_INTEREST = "Puppet show",
    Q_TELEROBOT_IDENT_1 = "Same nationality",
    Q_TELEROBOT_IDENT_2 = "Same age",
    Q_TELEROBOT_IDENT_3 = "Same gender",
    Q_TELEROBOT_IDENT_4 = "Same voice",
    Q_TELEROBOT_IDENT_5 = "Same religion",
    Q_TELEROBOT_IDENT_6 = "Bring additional objects",
    Q_TELEROBOT_IDENT_7 = "Would not reveal myself",
    Q_TELEROBOT_IDENT_8 = "Be someone else",
    Q_TELEROBOT_IDENT_G_1 = "Same nationality",
    Q_TELEROBOT_IDENT_G_2 = "Same age",
    Q_TELEROBOT_IDENT_G_3 = "Same gender",
    Q_TELEROBOT_IDENT_G_4 = "Same voice",
    Q_TELEROBOT_IDENT_G_6 = "Same religion",
    Q_TELEROBOT_IDENT_G_9 = "Bring additional objects",
    Q_TELEROBOT_IDENT_G_10 = "Would not reveal myself",
    Q_TELEROBOT_IDENT_G_11 = "Be someone else",
    IDENT_1_DIFF = "Same nationality",
    IDENT_2_DIFF = "Same age",
    IDENT_3_DIFF = "Same gender",
    IDENT_4_DIFF = "Same voice",
    IDENT_5_DIFF = "Same religion",
    IDENT_6_DIFF = "Bring additional objects",
    IDENT_7_DIFF = "Would not reveal myself",
    IDENT_8_DIFF = "Be someone else",
    Q_TELEROBOT_FEAT_1 = "Translate speech",
    Q_TELEROBOT_FEAT_2 = "Travel around",
    Q_TELEROBOT_FEAT_3 = "Hand gestures",
    Q_TELEROBOT_FEAT_4 = "Touch feedback",
    Q_TELEROBOT_FEAT_5 = "Show emotions",
    Q_TELEROBOT_FEAT_6 = "Play online content",
    Q_TELEROBOT_FEAT_7 = "Show personal content",
    Q_TELEROBOT_FEAT_8 = "Play games",
    Q_TELEROBOT_FEAT_9 = "Suggest topics",
    Q_TELEROBOT_FEAT_G_1 = "Translate speech",
    Q_TELEROBOT_FEAT_G_2 = "Travel around",
    Q_TELEROBOT_FEAT_G_3 = "Hand gestures",
    Q_TELEROBOT_FEAT_G_4 = "Touch feedback",
    Q_TELEROBOT_FEAT_G_5 = "Show emotions",
    Q_TELEROBOT_FEAT_G_6 = "Play online content",
    Q_TELEROBOT_FEAT_G_7 = "Show personal content",
    Q_TELEROBOT_FEAT_G_8 = "Play games",
    Q_TELEROBOT_FEAT_G_9 = "Suggest topics",
    FEAT_1_DIFF = "Translate speech",
    FEAT_2_DIFF = "Travel around",
    FEAT_3_DIFF = "Hand gestures",
    FEAT_4_DIFF = "Touch feedback",
    FEAT_5_DIFF = "Show emotions",
    FEAT_6_DIFF = "Play online content",
    FEAT_7_DIFF = "Show personal content",
    FEAT_8_DIFF = "Play games",
    FEAT_9_DIFF = "Suggest topics"
)
```

# Data outline

The following data is available for the survey participants.

## Demographics

 - **Age**: Continuous (1 year intervals, can be treated as continuous)
 - **Gender**: Nominal (Female/Male/Other).
 - **Tech confidence**: Ordinal (1-5).
 - **Spoken languages**: Nominal (checkboxes)
 - **Prior experience** - Dichotomous Y/N questions:
   1. Own a smartphone.
   2. Own a computer.
   3. Interacted with robots.
   4. Used glove puppets.
   5. Participated in intergroup encounters.
   6. Intergroup friends.


## General robot attitude

- **NARS Scale**: Continuous (lower is more positive attitude).
- **Feeling thermometer**: Continuous (higher is more positive).
- **Willingness to interact** - Ordinal 1-5s:
  1. _Approach_ a robot in a public space.
  2. _Own_ a robot used for interaction.
  3. _Operate_ a robot in a public space.
- **Imagine interaction**: Open text.

- **Interested to design a robot**: Dichotomous Y/N.

## Robot design preference

  - **What appearance** - Nominal: Human/animal or plant/machine/abstract/other
  - **How would it reflect me?** Dichotomous Y/N questions:
   1. Same nationality.
   2. Same age.
   3. Same gender.
   4. Same voice.
   5. Same religion.
   6. Additional objects.
   7. Not reveal anything.
   8. Be someone else.
   
 - **Features** - Ordinal 1-5s:
    1. Translate speech.
    2. Travel in space.
    3. Make hand gestures.
    4. Can tell when it is touched.
    5. Can show emotions.
    6. Can play content from the internet.
    7. Can show personal photos.
    8. Can play games.
    
  - **Other features** : Open text.
    
 - **Visiblity**: Nominal
   1. See and not be seee.
   2. See and be seen.
   3. Not see and not be seen.
   
## Robot puppet theater attitude
  - **Interested to perform**: Ordinal 1-5.
  - **What kind** : Open text.
  
## Attitude toward outgroup

- **Feeling thermometer**: Continuous (higher is more positive).
- - **Willingness to interact** - Ordinal 1-5s:
  1. _Operate_ a robot.
  2. _Perform_ a puppet.
  3. Face to face.
  4. Meet online.
  
## Robot preference when meeting outgroup

 - Duplicate of _Robot design preference_
 

# Research questions

## Respondents demographics


### Q: How many participants of each side reached the robot statements?
```{r}
Telerobot_ages %>% 
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
count(v)
```

### Q: How many male and female?
```{r}
Telerobot_ages %>% 
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
count(as_factor(Q_DEMOGRAPHICS_2))

Telerobot_ages %>% 
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
count(v,as_factor(Q_DEMOGRAPHICS_2))

Telerobot_ages %>% 
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
select(Q_AGE) %>%
summary
```

### Summary of age    
```{r}
Telerobot_ages %>% 
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
count(v)
```

### Q: Was there an age difference?
```{r}
Telerobot_ages %>% 
#dplyr::filter(Finished == 1) %>%
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
anova_test(Q_AGE ~ v,detailed = TRUE)

Telerobot_ages %>% 
#dplyr::filter(Finished == 1) %>%
dplyr::filter(!is.na(Q_ROBOT_STATEMENTS_1)) %>%
t_test(Q_AGE ~ v)
```

### Q: What was the distribution of tech confidence?
```{r}
Telerobot_ages %>%
select(v,Q_TECH_CONFIDENCE) %>%
drop_na() %>%
group_by(v) %>%
summarize(mean_tech_conf = mean(Q_TECH_CONFIDENCE), sd_tech_conf = sd(Q_TECH_CONFIDENCE))


ggdensity(
  Telerobot_ages %>%
  transmute(Q_TECH_CONFIDENCE = as.numeric(Q_TECH_CONFIDENCE),v) %>%
  drop_na() 
  ,x = "Q_TECH_CONFIDENCE", fill = "lightblue",facet.by = "v"
)

Telerobot_ages %>% 
select(v,Q_TECH_CONFIDENCE, Q_DEMOGRAPHICS_2, Q_AGE) %>%
drop_na() %>%
anova_test(Q_TECH_CONFIDENCE ~ v + Q_AGE + Q_DEMOGRAPHICS_2, detailed=TRUE )
```
### Q: What was the distribution of experience question
```{r}
df <- Telerobot_ages %>%
select(v,starts_with("Q_DEMOGRAPHICS_2_")) %>%
drop_na() %>%
mutate(across(starts_with("Q_DEMOGRAPHICS_2_"), ~(.x %% 2))) %>%
group_by(v) %>%
summarise(across(starts_with("Q_DEMOGRAPHICS_2_"), list(freq=~sum(.x) / n() * 100,yes=~sum(.x), no = ~n()-sum(.x))))

df

df %>%
dplyr::select(Q_DEMOGRAPHICS_2_3_yes,Q_DEMOGRAPHICS_2_3_no) %>%
chisq.test()
```

## General attitude toward robots

### Q: How are the robot feeling thermometers?
```{r}
ggdensity(Telerobot_ages %>% select(Q_ROBOTS_SLIDER_4,v),x = "Q_ROBOTS_SLIDER_4", fill = "lightblue",facet.by = "v")


df <- Telerobot_ages %>% 
select(Q_ROBOTS_SLIDER_4,v,Q_AGE, Q_DEMOGRAPHICS_2, Q_TECH_CONFIDENCE) %>% 
filter(Q_DEMOGRAPHICS_2 <= 2) %>%
mutate(Q_GENDER = as_factor(Q_DEMOGRAPHICS_2)) %>%
drop_na()

  
anova_test(df, Q_ROBOTS_SLIDER_4 ~ v * Q_AGE * Q_DEMOGRAPHICS_2,detailed = TRUE,effect.size = "pes")


ggbarplot(
   df, 
   x = "Q_GENDER",
   y = "Q_ROBOTS_SLIDER_4",
   add="mean",
  fill = "Q_GENDER",
   facet.by = "v",
  palette = get_palette("npg", 3)
)

```
### And NARS?
```{r}
ggdensity(Telerobot_ages %>% 
  select(Q_ROBOT_NARS, v) %>% 
    mutate(Q_ROBOT_NARS_INV = Q_ROBOT_NARS * -1) ,x = "Q_ROBOT_NARS_INV", fill = "lightgreen",facet.by = "v")

df <- Telerobot_ages %>% 
select(Q_ROBOT_NARS,v,Q_AGE, Q_DEMOGRAPHICS_2, Q_TECH_CONFIDENCE,Q_ROBOTS_SLIDER_4) %>% 
filter(Q_DEMOGRAPHICS_2 <= 2) %>%
mutate(Q_GENDER = as_factor(Q_DEMOGRAPHICS_2)) %>%
drop_na()

anova_test(df, Q_ROBOT_NARS ~ v * Q_AGE * Q_DEMOGRAPHICS_2, covariate = Q_TECH_CONFIDENCE, detailed = TRUE, effect.size = "pes")

ggbarplot(
   df, 
   x = "Q_GENDER",
   y = "Q_ROBOT_NARS",
   add="mean",
  fill = "Q_GENDER",
   facet.by = "v",
  palette = get_palette("npg", 3)
)


# Significance of different between men and women
rbind(
df %>%
filter(v == "IL") %>% 
t_test(Q_ROBOT_NARS ~ Q_GENDER),
df %>%
filter(v == "IL") %>% 
t_test(Q_ROBOTS_SLIDER_4 ~ Q_GENDER)
);


rbind(
  df %>%
filter(v == "PS") %>%
t_test(Q_ROBOT_NARS ~ Q_GENDER),
df %>%
filter(v == "PS") %>%
t_test(Q_ROBOTS_SLIDER_4 ~ Q_GENDER)
)

rbind(
  df %>%
filter(Q_GENDER == "Male") %>%
t_test(Q_ROBOT_NARS ~ v),
df %>%
filter(Q_GENDER == "Male") %>%
t_test(Q_ROBOTS_SLIDER_4 ~ v)
)

```
### NARS and tech confidence?
```{r}

df <- Telerobot_ages %>%
#filter(v == 'PS') %>%
select(v,Q_ROBOT_NARS, Q_TECH_CONFIDENCE,Q_ROBOTS_SLIDER_4, starts_with("Q_DEMOGRAPHICS_2_")) %>%
drop_na() %>%
mutate(across(starts_with("Q_DEMOGRAPHICS_2_"), ~(.x %% 2))) 

  
ggscatter(df, x = "Q_DEMOGRAPHICS_2_2", y = "Q_ROBOT_NARS",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = -10, label.y = 20)


summary(lm(Q_ROBOT_NARS ~ Q_DEMOGRAPHICS_2_2, data = df))
```
### What's the correlation between NARS and the feeling thermometer?
```{r}
ggscatter(Telerobot_ages, x = "Q_ROBOT_NARS", y = "Q_ROBOTS_SLIDER_4",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = 15, label.y = 60)
```


### General attitude toward the outgroup
```{r}
ggdensity(Telerobot_ages %>% 
  select(Q_GROUP_SLIDER_1, v)
  ,x = "Q_GROUP_SLIDER_1", fill = "lightgreen",facet.by = "v")

df <- Telerobot_ages %>% 
select(Q_GROUP_SLIDER_1,v,Q_AGE, Q_DEMOGRAPHICS_2) %>% 
filter(Q_DEMOGRAPHICS_2 <= 2) %>%
mutate(Q_GENDER = as_factor(Q_DEMOGRAPHICS_2)) %>%
drop_na()

df %>% 
group_by(v) %>%
summarise(across(c("Q_GROUP_SLIDER_1"), list(mean=mean,sd=sd,total=~n())))


anova_test(df, Q_GROUP_SLIDER_1 ~ v * Q_AGE * Q_DEMOGRAPHICS_2, detailed = TRUE, effect.size = "pes")

ggscatter(df, x = "Q_AGE", y = "Q_GROUP_SLIDER_1",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = 15, label.y = 60)

ggbarplot(
   df, 
   x = "Q_GENDER",
   y = "Q_GROUP_SLIDER_1",
   add="mean",
  fill = "Q_GENDER",
   facet.by = "v",
  palette = get_palette("npg", 3)
)


# Significance of different between men and women

rbind(
df %>%
filter(v == "IL") %>% 
t_test(Q_GROUP_SLIDER_1 ~ Q_GENDER),
df %>%
filter(v == "PS") %>%
t_test(Q_GROUP_SLIDER_1 ~ Q_GENDER)
)
```
## Willingness to interact with a robot

### Q: What were the frequencies in each scenario?
```{r}
df <- Telerobot_ages %>%
filter(Q_DEMOGRAPHICS_2 <= 2) %>%
mutate(Q_GENDER = as_factor(Q_DEMOGRAPHICS_2)) %>%
#filter(Q_GENDER == 'Female') %>%
#filter(v == 'IL') %>%
select(v,starts_with("Q_TELEROBOT_WOULD_U"), Q_GENDER, Q_AGE, Q_TECH_CONFIDENCE, Q_ROBOT_NARS) %>%
drop_na()

c("Q_TELEROBOT_WOULD_U_1","Q_TELEROBOT_WOULD_U_2","Q_TELEROBOT_WOULD_U_3") %>%
#map(~ data.frame(append(anova_test(as.formula(paste0(.x," ~ v * Q_GENDER * Q_AGE")), data=df),c(test=.x))))
map(~ anova_test(as.formula(paste0(.x," ~ v * Q_AGE * Q_GENDER")), data=df,effect.size = "pes"),c(test=.x))


df %>%
group_by(v, Q_GENDER) %>%
summarise(across(starts_with("Q_TELEROBOT_WOULD_U"), list(mean=mean)))


ggscatter(df, x = "Q_AGE", y = "Q_TELEROBOT_WOULD_U_1",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = 15, label.y = 60)

ggbarplot(
   df,
   x = "Q_GENDER",
   y = "Q_TELEROBOT_WOULD_U_1",
   add="mean",
  fill = "Q_GENDER",
   facet.by = "v",
  palette = get_palette("npg", 3)
)


ggscatter(df, x = "Q_ROBOT_NARS", y = "Q_TELEROBOT_WOULD_U_1",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
        #  facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = -15, label.y = 60)

ggbarplot(
   df,
   x = "Q_GENDER",
   y = "Q_TELEROBOT_WOULD_U_2",
   add="mean",
  fill = "Q_GENDER",
   facet.by = "v",
  palette = get_palette("npg", 3)
)

ggbarplot(
   df,
   x = "Q_GENDER",
   y = "Q_TELEROBOT_WOULD_U_3",
   add="mean",
  fill = "Q_GENDER",
   facet.by = "v",
  palette = get_palette("npg", 3)
)


ggscatter(df, x = "Q_ROBOT_NARS", y = "Q_TELEROBOT_WOULD_U_3",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
   #       facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = -15, label.y = 60)


```

## Telerobot preference


### Q: Would Israerlies use a robot for shopping significantly more than Palestinians?
```{r}
Telerobot_sorted %>% 
select("Q_TELEROBOT_IMAGINE_TRANS",'v') %>%
drop_na() %>%
mutate(ROBOT_SHOPPING = ifelse(grepl(".*shop.*", Q_TELEROBOT_IMAGINE_TRANS,ignore.case = TRUE), "Yes", "No")) %>%
group_by(v, ROBOT_SHOPPING) %>%
summarize(n = n()) %>%
spread(ROBOT_SHOPPING ,n) %>%
ungroup %>%
dplyr::select(-v) %>%
chisq.test()


```

### Robot appearance style
```{r, fig.width=10,fig.asp=0.5}
df <-
  Telerobot_ages %>% select("Q_TELEROBOT_APP", 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(Appearance=as_factor(Q_TELEROBOT_APP)) %>%
  group_by(v,Appearance) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n) * 100, total_n = sum(n))

df

Telerobot_ages %>% select("Q_TELEROBOT_APP", "Q_TELEROBOT_APP_5_TEXT", 'ResponseId','v') %>%
  filter(as_factor(Q_TELEROBOT_APP) == "Other:")

 ggbarplot(
   df, 
   y = "freq",
   fill = "Appearance",
   facet.by = "v",
   panel.labs = list(v = c(
     paste0("IL (n = ",(df %>% filter(v == 'IL'))$total_n[1] ,")"),
     paste0("PS (n = ",(df %>% filter(v == 'PS'))$total_n[1] ,")")
   )),
   palette = get_palette("npg", 5)
) + coord_polar("y", start=0) + 
     theme(
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
      )

  Telerobot_ages %>% select("Q_TELEROBOT_APP", 'v') %>%    
  drop_na() %>%
  mutate(Human = ifelse(as_factor(Q_TELEROBOT_APP) == "A human.", 1, 0), Nonhuman = ifelse(as_factor(Q_TELEROBOT_APP) == "A human.", 0, 1))  %>%
  group_by(v) %>%
  summarise(across(c('Human', 'Nonhuman'), list(sum = sum, freq = ~sum(.x) / n())))

```
### In outgroup scenario
```{r, fig.width=10,fig.height=5}
df <-
  Telerobot_ages %>% select("Q_TELEROBOT_APP_G", 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(Appearance=as_factor(Q_TELEROBOT_APP_G)) %>%
  group_by(v,Appearance) %>%
  summarise(n = n()) %>%
  mutate(freq = (n / sum(n)) * 100, total_n = sum(n),
  lab.ypos=cumsum(freq) - 0.5*freq)


df

 ggbarplot(
   df, 
   y = "freq",
   fill = "Appearance",
   facet.by = "v",
   panel.labs = list(v = c(
     paste0("IL (n = ",(df %>% filter(v == 'IL'))$total_n[1] ,")"),
     paste0("PS (n = ",(df %>% filter(v == 'PS'))$total_n[1] ,")")
   )),
   palette = get_palette("npg", 5)
) + coord_polar("y", start=0) + 
        theme(
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
      )
 
   Telerobot_ages %>% select("Q_TELEROBOT_APP_G", 'v') %>%    
  drop_na() %>%
  mutate(Human = ifelse(as_factor(Q_TELEROBOT_APP_G) == "A human.", 1, 0), Nonhuman = ifelse(as_factor(Q_TELEROBOT_APP_G) == "A human.", 0, 1))  %>%
  group_by(v) %>%
  summarise(across(c('Human', 'Nonhuman'), list(sum = sum, freq = ~sum(.x) / n())))

```


### Q: Do Palestinians want significantly more a nonhuman appearance than Israelis?
```{r}
   Telerobot_ages %>% select("Q_TELEROBOT_APP", 'v') %>%    
  drop_na() %>%
  mutate(Human = ifelse(as_factor(Q_TELEROBOT_APP) == "A human.", 1, 0), Nonhuman = ifelse(as_factor((Q_TELEROBOT_APP)) == "A human.", 0, 1))  %>%
  group_by(v) %>%
  summarise(across(c('Human', 'Nonhuman'), list(sum = sum))) %>%
  select(-v) %>%
  chisq.test()
```


### Q: Do Palestinians want significantly more a machine/human appearance than Israelis?

Need to do:CHI-Square
Can check AGE covariance with binary logistics
https://statsandr.com/blog/chi-square-test-of-independence-in-r/

```{r}
df <- Telerobot_ages %>% 
select("Q_TELEROBOT_APP_G", 'ResponseId','v') %>%
drop_na() %>%
mutate(APP_MACHINE = ifelse(as_factor(Q_TELEROBOT_APP_G) == 'A machine.', "Machine", "Not machine")) %>%
group_by(v, APP_MACHINE) %>%
summarize(n = n()) %>%
spread(APP_MACHINE,n) %>%
ungroup %>%
dplyr::select(-v) 

df

df %>% chisq.test()

df <- Telerobot_ages %>% 
select("Q_TELEROBOT_APP_G", 'ResponseId','v') %>%
drop_na() %>%
mutate(APP_HUMAN = ifelse(as_factor(Q_TELEROBOT_APP_G) == 'A human.', "Human", "Not human")) %>%
group_by(v, APP_HUMAN) %>%
summarize(n = n()) %>%
spread(APP_HUMAN,n) %>%
ungroup %>%
dplyr::select(-v) 

df

df %>% chisq.test()

```
### A: Chi-Sq is significant only in the outgroup scenario
### Q: Are those people's nationality predicted by age or gender?

```{r}
Telerobot_ages %>% 
mutate(v = as_factor(v)) %>%
select("Q_TELEROBOT_APP_G", 'ResponseId','v','Q_AGE', 'Q_DEMOGRAPHICS_2') %>%
drop_na() %>%
glm(v ~ Q_AGE + Q_DEMOGRAPHICS_2, ., family=binomial) %>% 
summary
```

### Comparision of frequendcies between outgruop meeting and normal

```{r, fig.width=10}

df <-
  melt(
      Telerobot_ages %>% 
      mutate(Normal=as_factor(Q_TELEROBOT_APP),Outgroup=as_factor(Q_TELEROBOT_APP_G)) %>%
      select("Normal", "Outgroup", 'ResponseId','v') %>%    
      drop_na(),
      id=c('ResponseId','v'),variable.name = "Appearance"
  ) %>%
  group_by(v,Appearance,value) %>%
  summarise(n = n()) %>%
  mutate(freq = round(n / sum(n), digits = 2) * 100, total_n = sum(n))

df

 ggplot(df, aes(x=reorder(value, freq),y=freq,fill=Appearance)) +
 ylab("Frequency") +
 xlab("Robot appearance") +
 geom_bar(position="dodge", stat="identity") +
 coord_flip() +
 facet_wrap(~ v,
     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$total_n[1] ,")")))
 )
```
### Which were changed?
```{r, fig.width=15}

appr <- attributes(Telerobot_ages$Q_TELEROBOT_APP)$labels;

df <-  Telerobot_ages %>% 
       select(ResponseId, v,Q_TELEROBOT_APP,Q_TELEROBOT_APP_G) %>%
       drop_na() 

for (name in names(appr)) {
 for (alt_name in names(appr)) {
    df[[paste0(name, " -> ",alt_name)]] = with(df, ifelse(Q_TELEROBOT_APP == appr[name] & Q_TELEROBOT_APP_G == appr[alt_name], 1, 0))
 }
}

melt_df <-
  melt(
      df %>%
      select(-Q_TELEROBOT_APP,-Q_TELEROBOT_APP_G) %>%
      drop_na(),
      id=c('ResponseId','v'),variable.name = "Appearance"
   ) %>%
  
   group_by(v,Appearance) %>%
   summarise(total_n = n(), sum=sum(value))

 melt_df %>% arrange(desc(sum))

 ggplot(melt_df, aes(x=reorder(Appearance, sum),y=sum,fill=Appearance)) +
 ylab("Occurences") +
 xlab("Robot appearance") +
 geom_bar(position="dodge", stat="identity") +
 coord_flip() +
 facet_wrap(~ v,
     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(melt_df %>% filter(v == .x))$total_n[1] ,")")))
 )
```



### Q: How did participants prefer the robot identity? 
From those that selected anything.
```{r, fig.width=10,fig.asp=0.5}

base_df <- 
  Telerobot_ages %>% select(matches("^Q_TELEROBOT_IDENT_\\d$"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT")),replace_na, 0)
  
df <- melt(
  base_df %>%
  plyr::rename(COLUMN_DICTIONARY)
 , id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
  group_by(v,IDENT) %>%
  summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n())))

df

  ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=IDENT)) +
  ylab("Percentage") +
  xlab("Robot identity") +
  geom_bar(stat="identity") +
  coord_flip() +
  facet_wrap(~ v,
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
  )

  
ident_cols <- Telerobot_ages %>% select(matches("^Q_TELEROBOT_IDENT_\\d$")) %>% colnames

chi_res <- NULL

for (ident_col in ident_cols) {
  
  res <- base_df %>% 
  mutate(SELECCTED = ifelse(!! sym(ident_col) == 1, "Yes", "No")) %>%
  group_by(v, SELECCTED) %>%
  summarize(n = n()) %>%
  spread(SELECCTED,n) %>%
  ungroup %>%
  dplyr::select(-v) %>%
  chisq.test()
  
  res_tibble <- tidy(res)
  res_tibble["Field"] <- COLUMN_DICTIONARY[ident_col]
  
  if (is.null(chi_res)) {
    chi_res <- res_tibble
  } else {
    chi_res <-bind_rows(chi_res,res_tibble)
  }
}

chi_res
```
### And when meeting the outgroup?
```{r, fig.width=10}
base_df <-
  Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_G"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_G")),replace_na, 0)
  

df <- melt(
  base_df %>%
  plyr::rename(COLUMN_DICTIONARY)
 , id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
  group_by(v,IDENT) %>%
  summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n())))

df

ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=IDENT)) +
ylab("Percentage") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() +
facet_wrap(~ v, 
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)

ident_g_cols <- Telerobot_ages %>% select(matches("^Q_TELEROBOT_IDENT_G")) %>% colnames

chi_res <- NULL

for (ident_col in ident_g_cols) {
  
  res <- base_df %>% 
  mutate(SELECCTED = ifelse(!! sym(ident_col) == 1, "Yes", "No")) %>%
  group_by(v, SELECCTED) %>%
  summarize(n = n()) %>%
  spread(SELECCTED,n) %>%
  ungroup %>%
  dplyr::select(-v) %>%
  chisq.test()
  
  res_tibble <- tidy(res)
  res_tibble["Field"] <- COLUMN_DICTIONARY[ident_col]
  
  if (is.null(chi_res)) {
    chi_res <- res_tibble
  } else {
    chi_res <-bind_rows(chi_res,res_tibble)
  }
}

chi_res

```
### Comparision of means between meeting and normal

```{r, fig.width=10}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)
 , id=c('ResponseId','v'),variable.name = "IDENT"
) %>%
  group_by(v,IDENT) %>%
  summarise(across(c("value"), list(freq = ~sum(.x)/n() * 100, n = ~ n()))) %>%
  mutate(type = if_else(grepl("Q_TELEROBOT_IDENT_G", IDENT),"Outgroup","Normal")) %>%
  mutate(across(IDENT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))

 ggplot(df, aes(x=reorder(IDENT, -value_freq),y=value_freq,fill=type)) +
 ylab("Percentage") +
 xlab("Robot identity") +
 geom_bar(position="dodge", stat="identity") +
 coord_flip() +
 facet_wrap(~ v,
     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
 )
```

### Did Israelis prefer to have the same nationality in the outgroup scenario?
```{r}
base_df <- Telerobot_ages %>% select(matches("Q_TELEROBOT_IDENT_"), 'ResponseId','v') %>%    
  filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0)

df <- melt(
  base_df %>%
  filter (v == "PS") %>%
  select("Q_TELEROBOT_IDENT_5", "Q_TELEROBOT_IDENT_G_6","ResponseId")  # Religion
  #select("Q_TELEROBOT_IDENT_2", "Q_TELEROBOT_IDENT_G_2","ResponseId")  # age
  #select("Q_TELEROBOT_IDENT_3", "Q_TELEROBOT_IDENT_G_3","ResponseId")  # gender
  #select("Q_TELEROBOT_IDENT_4", "Q_TELEROBOT_IDENT_G_4","ResponseId")  # voice
  #select("Q_TELEROBOT_IDENT_8", "Q_TELEROBOT_IDENT_G_11","ResponseId")  # be someone else
  #select("Q_TELEROBOT_IDENT_7", "Q_TELEROBOT_IDENT_G_10","ResponseId")  # not reveal myself

 , id=c('ResponseId'),variable.name = "IDENT"
) %>%
  group_by(IDENT) %>%
  summarise(across(c("value"), list(yes = ~sum(.x), no = ~ n() - sum(.x)))) 

df

df %>% select(-IDENT) %>% chisq.test


```


### Means of individual difference between normal and outgruop
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>%  
  filter(if_any(starts_with("Q_TELEROBOT_IDENT_G"), ~ . == 1)) %>%
  mutate_at(vars(starts_with("Q_TELEROBOT_IDENT_")),replace_na, 0) %>%
  mutate(
    IDENT_1_DIFF = Q_TELEROBOT_IDENT_G_1 - Q_TELEROBOT_IDENT_1,
    IDENT_2_DIFF = Q_TELEROBOT_IDENT_G_2 - Q_TELEROBOT_IDENT_2,
    IDENT_3_DIFF = Q_TELEROBOT_IDENT_G_3 - Q_TELEROBOT_IDENT_3,
    IDENT_4_DIFF = Q_TELEROBOT_IDENT_G_4 - Q_TELEROBOT_IDENT_4,
    IDENT_5_DIFF = Q_TELEROBOT_IDENT_G_6 - Q_TELEROBOT_IDENT_5,
    IDENT_6_DIFF = Q_TELEROBOT_IDENT_G_9 - Q_TELEROBOT_IDENT_6,
    IDENT_7_DIFF = Q_TELEROBOT_IDENT_G_10 - Q_TELEROBOT_IDENT_7,
    IDENT_8_DIFF = Q_TELEROBOT_IDENT_G_11 - Q_TELEROBOT_IDENT_8
  ) %>% 
  select(matches("_DIFF"), 'ResponseId','v')  %>% plyr::rename(COLUMN_DICTIONARY,warn_missing = FALSE)
 , id=c('ResponseId','v'),variable.name = "IDENT_DIFF"
) %>%
group_by(v,IDENT_DIFF) %>%
summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n())))

df

ggplot(df, aes(x=reorder(IDENT_DIFF, -value_mean),y=value_mean,fill=IDENT_DIFF)) + 
ylab("Mean individual difference between outgroup and normal scenario") +
xlab("Robot identity") +
geom_bar(stat="identity") +
coord_flip() + 
facet_wrap(~ v, 
  labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)

```

### Q: How did participants rate the robot's feature importance? 
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>% select(matches("^Q_TELEROBOT_FEAT_\\d$"), 'ResponseId','v') %>%    
  drop_na() %>%
  plyr::rename(COLUMN_DICTIONARY,warn_missing = FALSE)
 , id=c('ResponseId','v'),variable.name = "FEAT"
) %>%
  group_by(v,FEAT) %>%
  summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n())))

  ggplot(df, aes(x=reorder(FEAT, -value_mean),y=value_mean,fill=FEAT)) + 
  ylab("Mean rank") +
  xlab("Robot feature") +
  geom_bar(stat="identity") +
  coord_flip() + 
  facet_wrap(~ v, 
    labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
  )
 
```

## Comparison between normnal and outgroup meeting
```{r, fig.width=10}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_FEAT_"), 'ResponseId','v') %>%    
  drop_na()
 , id=c('ResponseId','v'),variable.name = "FEAT"
) %>%
  group_by(v,FEAT) %>%
  summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n()))) %>%
  mutate(type = if_else(grepl("Q_TELEROBOT_FEAT_G", FEAT),"Outgroup","Normal")) %>%
  mutate(across(FEAT, ~ unlist(map(.x,~ COLUMN_DICTIONARY[toString(.x)]))))

 ggplot(df, aes(x=reorder(FEAT, -value_mean),y=value_mean,fill=type)) +
 ylab("Mean") +
 xlab("Robot feature") +
 geom_bar(position="dodge", stat="identity") +
 coord_flip() +
 facet_wrap(~ v,
     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
 )
```
### And individual change
```{r, fig.width=10,fig.asp=0.5}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_FEAT_"), 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(
    FEAT_1_DIFF = Q_TELEROBOT_FEAT_G_1 - Q_TELEROBOT_FEAT_1,
    FEAT_2_DIFF = Q_TELEROBOT_FEAT_G_2 - Q_TELEROBOT_FEAT_2,
    FEAT_3_DIFF = Q_TELEROBOT_FEAT_G_3 - Q_TELEROBOT_FEAT_3,
    FEAT_4_DIFF = Q_TELEROBOT_FEAT_G_4 - Q_TELEROBOT_FEAT_4,
    FEAT_5_DIFF = Q_TELEROBOT_FEAT_G_5 - Q_TELEROBOT_FEAT_5,
    FEAT_6_DIFF = Q_TELEROBOT_FEAT_G_6 - Q_TELEROBOT_FEAT_6,
    FEAT_7_DIFF = Q_TELEROBOT_FEAT_G_7 - Q_TELEROBOT_FEAT_7,
    FEAT_8_DIFF = Q_TELEROBOT_FEAT_G_8 - Q_TELEROBOT_FEAT_8,
    FEAT_9_DIFF = Q_TELEROBOT_FEAT_G_9 - Q_TELEROBOT_FEAT_9
  ) %>% 
  select(matches("_DIFF"), 'ResponseId','v')  %>% plyr::rename(COLUMN_DICTIONARY,warn_missing = FALSE)
 , id=c('ResponseId','v'),variable.name = "FEAT_DIFF"
) %>%
group_by(v,FEAT_DIFF) %>%
summarise(across(c("value"), list(mean = ~mean(.x), n = ~ n())))

ggplot(df, aes(x=reorder(FEAT_DIFF, -value_mean),y=value_mean,fill=FEAT_DIFF)) + 
ylab("Mean individual difference between outgroup and normal scenario") +
xlab("Robot features") +
geom_bar(stat="identity") +
coord_flip() + 
facet_wrap(~ v, 
  labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$value_n[1] ,")")))
)
```

### Visibility preferences
```{r, fig.width=10,fig.asp=0.5}
df <-
  Telerobot_ages %>% select("Q_TELEROBOT_DISP", 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(Visibility=as_factor(Q_TELEROBOT_DISP)) %>%
  group_by(v,Visibility) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n), total_n = sum(n))

df

 ggbarplot(
   df, 
   y = "freq",
   fill = "Visibility",
   facet.by = "v",
   panel.labs = list(v = c(
     paste0("IL (n = ",(df %>% filter(v == 'IL'))$total_n[1] ,")"),
     paste0("PS (n = ",(df %>% filter(v == 'PS'))$total_n[1] ,")")
   )),
   palette = get_palette("npg", 5)
) + coord_polar("y", start=0) + 
     theme(
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
      )
```  

### In outgroup scenario
```{r, fig.width=10,fig.asp=0.5}
df <-
  Telerobot_ages %>% select("Q_TELEROBOT_DISP_G", 'ResponseId','v') %>%    
  drop_na() %>%
  mutate(Visibility=as_factor(Q_TELEROBOT_DISP_G)) %>%
  group_by(v,Visibility) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n), total_n = sum(n))

 ggbarplot(
   df, 
   y = "freq",
   fill = "Visibility",
   facet.by = "v",
   panel.labs = list(v = c(
     paste0("IL (n = ",(df %>% filter(v == 'IL'))$total_n[1] ,")"),
     paste0("PS (n = ",(df %>% filter(v == 'PS'))$total_n[1] ,")")
   )),
   palette = get_palette("npg", 5)
) + coord_polar("y", start=0) + 
     theme(
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
      )
```  
### Comparion betwen same population
```{r, fig.width=10}
df <- melt(
  Telerobot_ages %>% select(matches("Q_TELEROBOT_DISP"), 'ResponseId','v') %>%    
  mutate(Q_TELEROBOT_DISP_G=as_factor(Q_TELEROBOT_DISP_G)) %>%
  mutate(Q_TELEROBOT_DISP=as_factor(Q_TELEROBOT_DISP)) %>%
  drop_na()
 , id=c('ResponseId','v'),variable.name = "Visibility"
) %>%
  group_by(v,Visibility,value) %>%
  summarise(n = n(), freq = sum(n)) %>%
  mutate(freq = n / sum(n), total_n = sum(n)) %>%
  mutate(type = if_else(grepl("Q_TELEROBOT_DISP_G", Visibility),"Outgroup","Normal"))

df

 ggplot(df, aes(x=reorder(value, -freq),y=freq,fill=type)) +
 ylab("Frequency") +
 xlab("Visibility") +
 geom_bar(position="dodge", stat="identity") +
 coord_flip() +
 facet_wrap(~ v,
     labeller = as_labeller(~map(.x,~paste0(.x, " (n = ",(df %>% filter(v == .x))$total_n[1] ,")")))
 )
```

## General attitude toward outgroup

## Interest in contact

### Q: How the outgruop feeling thermometers distributed?
```{r}
ggdensity(Telerobot_ages %>% select(Q_GROUP_SLIDER_1,v),x = "Q_GROUP_SLIDER_1", fill = "lightgray",facet.by = "v")
```
### Q: How willing are the groups to meat each other with the different scenarios?

```{r, fig.width=10,fig.asp=0.5}
  ggsummarystats(
  melt(Telerobot_ages %>% select(starts_with("Q_GROUP_INTEREST"), 'ResponseId','v') %>% drop_na() %>%     plyr::rename(COLUMN_DICTIONARY), id=c('ResponseId','v'),variable.name = "INTEREST"),
  x = "INTEREST", y = "value",
  ggfunc = ggboxplot, palette="npg", add="jitter", color="INTEREST",
  summaries = c("n", "median", "mean"),
  digits = 3,
  table.font.size = 3,
  facet.by = "v",
)

df <- Telerobot_ages %>%
filter(Q_DEMOGRAPHICS_2 <= 2) %>%
mutate(Q_GENDER = as_factor(Q_DEMOGRAPHICS_2)) %>%
#filter(Q_GENDER == 'Female') %>%
#filter(v == 'PS') %>%
select(v,starts_with("Q_GROUP_INTEREST"), Q_GENDER, Q_AGE, Q_TECH_CONFIDENCE, Q_ROBOT_NARS) %>%
drop_na()

c("Q_GROUP_INTEREST_1","Q_GROUP_INTEREST_2","Q_GROUP_INTEREST_3","Q_GROUP_INTEREST_4") %>%
#map(~ data.frame(append(anova_test(as.formula(paste0(.x," ~ v * Q_GENDER * Q_AGE")), data=df),c(test=.x))))
map(~ anova_test(as.formula(paste0(.x," ~  Q_AGE")), data=df,effect.size = "pes"),c(test=.x))


df %>%
group_by(v) %>%
summarise(across(starts_with("Q_GROUP_INTEREST"), list(mean=mean)))


ggscatter(df, x = "Q_AGE", y = "Q_GROUP_INTEREST_1",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = -15, label.y = 60)

ggscatter(df, x = "Q_AGE", y = "Q_GROUP_INTEREST_2",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = -15, label.y = 60)


ggscatter(df, x = "Q_AGE", y = "Q_GROUP_INTEREST_3",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = -15, label.y = 60)

ggscatter(df, x = "Q_AGE", y = "Q_GROUP_INTEREST_4",
          add = "reg.line",                                 # Add regression line
          conf.int = TRUE,                                  # Add confidence interval
          facet.by = "v",
          add.params = list(color = "blue",
                            fill = "lightgray")
          )+
  stat_cor(method = "pearson", label.x = -15, label.y = 60)


```
``


### Did palestinians significantly prefer roboic over non robotic?
```{r}
df <- Telerobot_sorted %>% 
filter(v == 'PS') %>%
select(starts_with("Q_GROUP_INTEREST"),'v') %>%
drop_na() %>%
mutate(ROBOT_INTEREST=Q_GROUP_INTEREST_1 + Q_GROUP_INTEREST_2, NON_ROBOT_INTEREST=Q_GROUP_INTEREST_3 + Q_GROUP_INTEREST_4) 

wilcox.test(df$ROBOT_INTEREST, df$NON_ROBOT_INTEREST, paired=TRUE) 
  


# spread(ROBOT_SHOPPING ,n) %>%
# ungroup %>%
# dplyr::select(-v) %>%
# chisq.test()

```



## Potential of telepuppets

### Q: Interest of puppet show in general
```{r, fig.width=10,fig.asp=0.5}
  ggsummarystats(
  Telerobot_ages %>% select('Q_PUPPET_INTEREST', 'ResponseId','v') %>% drop_na(),
  x = "v", y = "Q_PUPPET_INTEREST",
  ggfunc = ggboxplot, palette="npg", add="jitter", color="v",
  summaries = c("n", "median", "mean"),
  digits = 3,
  table.font.size = 3
)
```
### Q: Interest of puppet show in general - what effects - ANOVA?


### Q: Interest of puppet show in general - what effects - Correlation Matrix?
```{r}
corr_vars <- c(
    "Q_ROBOT_NARS",
    "Q_AGE",
    "Q_TECH_CONFIDENCE",
    "Q_PUPPET_INTEREST"
  )

names <- c(
    "NARS",
    "Age",
    "Tech confidence",
    "Puppet show"
  )
Telerobot_ages %>%
  dplyr::select(
    "v",
    corr_vars
  ) %>%
  drop_na %>%
  mutate_all(as.numeric) %>%
  ggcorrmat(
    cor.vars = corr_vars, cor.vars.names = names
)
```


### Q: What is the level of interest in performing a puppet show? How do these compare with other interests
```{r, fig.width=10,fig.asp=0.5}
  ggsummarystats(
  melt(Telerobot_ages %>% select(starts_with("Q_GROUP_INTEREST"), 'Q_SHOW_INTEREST', 'ResponseId','v') %>% drop_na() %>%     plyr::rename(COLUMN_DICTIONARY), id=c('ResponseId','v'),variable.name = "INTEREST"),
  x = "INTEREST", y = "value",
  ggfunc = ggboxplot, palette="npg", add="jitter", color="INTEREST",
  summaries = c("n", "median", "mean"),
  digits = 3,
  table.font.size = 3,
  facet.by = "v",
)
```

Generally there was
Since only 27 Palestinians made it to this stage, it might be best to investigate individual stories.

### Q: How were answers to the puppet show relative to average interest to meeet?


```{r}
Telerobot_ages %>% select(starts_with("Q_GROUP_INTEREST"), 'ResponseId','v', 'Q_SHOW_INTEREST') %>% drop_na() %>%     
mutate(Q_GROUP_INTEREST_AVG = rowMeans(select(.,starts_with("Q_GROUP_INTEREST")), na.rm = TRUE)) %>%
mutate(DIFF = Q_SHOW_INTEREST - Q_GROUP_INTEREST_AVG) %>%
  group_by(v) %>%
  get_summary_stats(DIFF)
```
There was generally less interest in the puppet show


